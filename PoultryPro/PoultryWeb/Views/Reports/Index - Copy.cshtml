@model ReportRequestModel
@{
    ViewBag.Title = "Report Export";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Generate Report</h2>

<form method="post" asp-action="ExportCsv">
    <div class="form-group">
        <label>Report Type</label>
        <select asp-for="ReportType" class="form-control">
            <option value="EggProduction">Egg Production</option>
            <option value="Sales">Sales</option>
            <option value="Expenses">Expenses</option>
        </select>
    </div>
    <div class="form-group">
        <label>Start Date</label>
        <input asp-for="StartDate" type="date" class="form-control" />
    </div>
    <div class="form-group">
        <label>End Date</label>
        <input asp-for="EndDate" type="date" class="form-control" />
    </div>
    <input type="submit" value="Export as CSV" class="btn btn-success" />
</form>

<form method="post" asp-action="ExportPdf" class="mt-2">
    <input type="hidden" class="hidden-reportType" name="ReportType" />
    <input type="hidden" class="hidden-startDate" name="StartDate" />
    <input type="hidden" class="hidden-endDate" name="EndDate" />
    <input type="submit" value="Export as PDF" class="btn btn-primary btn-export" />
</form>

<form method="post" asp-action="ExportExcel" class="mt-2">
    <input type="hidden" class="hidden-reportType" name="ReportType" />
    <input type="hidden" class="hidden-startDate" name="StartDate" />
    <input type="hidden" class="hidden-endDate" name="EndDate" />
    <input type="submit" value="Export as Excel" class="btn btn-info btn-export" />
</form>



@section Scripts {
    <script>
        function syncReportFilters() {
            const reportType = document.querySelector('[name="ReportType"]').value;
            const startDate = document.querySelector('[name="StartDate"]').value;
            const endDate = document.querySelector('[name="EndDate"]').value;

            document.querySelectorAll('.hidden-reportType').forEach(e => e.value = reportType);
            document.querySelectorAll('.hidden-startDate').forEach(e => e.value = startDate);
            document.querySelectorAll('.hidden-endDate').forEach(e => e.value = endDate);
        }

        // Hook it to buttons
        document.querySelectorAll('.btn-export').forEach(button => {
            button.addEventListener('click', syncReportFilters);
        });
    </script>
}
